import express from "express";
import { uploadExcel, uploadPdfOrExcel } from "../middlewares/upload.js";
import { getUserVulnerabilityReportBatches, getVulnerabilityReportByBatch, updateSeverityBulk, uploadVulnerabilityReport } from "../controllers/vulnerabilityReport.controllers.js";
import { authorize } from "../middlewares/authorize.js";

const vulnerabilityReportRoutes = express.Router();

vulnerabilityReportRoutes.post("/upload",authorize(["admin"]), uploadPdfOrExcel, uploadVulnerabilityReport);
vulnerabilityReportRoutes.get("/batches", authorize(["admin", "viewer", "editor"]), getUserVulnerabilityReportBatches);
vulnerabilityReportRoutes.get("/batches/:batchId", authorize(["admin", "viewer", "editor"]), getVulnerabilityReportByBatch);
vulnerabilityReportRoutes.put("/severity", authorize(["admin", "editor"]), updateSeverityBulk);

export default vulnerabilityReportRoutes;