import express from "express";
import { uploadExcel } from "../middlewares/upload.js";
import { getUserVulnerabilityReportBatches, getVulnerabilityReportByBatch, updateSeverityBulk, uploadVulnerabilityReport } from "../controllers/vulnerabilityReport.controllers.js";
import { authorize } from "../middlewares/authorize.js";

const vulnerabilityReportRoutes = express.Router();

vulnerabilityReportRoutes.post("/upload",authorize(["admin"]), uploadExcel, uploadVulnerabilityReport);
vulnerabilityReportRoutes.get("/batches", authorize(["admin"]), getUserVulnerabilityReportBatches);
vulnerabilityReportRoutes.get("/batches/:batchId", authorize(["admin"]), getVulnerabilityReportByBatch);
vulnerabilityReportRoutes.put("/severity", authorize(["admin"]), updateSeverityBulk);

export default vulnerabilityReportRoutes;