import express from "express";
import { uploadExcel } from "../middlewares/upload.js";
import { getUserVulnerabilityReportBatches, getVulnerabilityReportByBatch, updateSeverityBulk, uploadVulnerabilityReport } from "../controllers/vulnerabilityReport.controllers.js";
import { authorize } from "../middlewares/authorize.js";

const vulnerabilityReportRoutes = express.Router();

vulnerabilityReportRoutes.post("/upload",authorize(["user"]), uploadExcel, uploadVulnerabilityReport);
vulnerabilityReportRoutes.get("/batches", authorize(["user"]), getUserVulnerabilityReportBatches);
vulnerabilityReportRoutes.get("/batches/:batchId", authorize(["user"]), getVulnerabilityReportByBatch);
vulnerabilityReportRoutes.put("/severity", authorize(["user"]), updateSeverityBulk);

export default vulnerabilityReportRoutes;